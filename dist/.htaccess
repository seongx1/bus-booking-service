# Cloudways 배포용 .htaccess 설정
# 정적 웹사이트 라우팅 및 최적화 설정

# 기본 인코딩 설정
AddDefaultCharset UTF-8

# 다국어 지원을 위한 인덱스 파일 우선순위
DirectoryIndex index.html index_v2.html index_v2_ko.html index_v2_ja.html index_v2_zh.html

# GZIP 압축 활성화
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# 브라우저 캐싱 설정
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/ico "access plus 1 year"
    ExpiresByType image/icon "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType text/html "access plus 1 day"
</IfModule>

# 보안 헤더 설정
<IfModule mod_headers.c>
    # XSS 방지
    Header set X-XSS-Protection "1; mode=block"
    # 클릭재킹 방지
    Header always append X-Frame-Options SAMEORIGIN
    # MIME 타입 스니핑 방지
    Header set X-Content-Type-Options "nosniff"
    # HTTPS 강제 (SSL 적용 후 활성화)
    # Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
</IfModule>

# URL 리다이렉트 규칙
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # www 없이 접속 시 www 추가 (선택사항)
    # RewriteCond %{HTTP_HOST} !^www\. [NC]
    # RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L]
    
    # index.html 리다이렉트
    RewriteCond %{THE_REQUEST} /index\.html[\s?] [NC]
    RewriteRule ^index\.html$ /index_v2.html [R=301,L]
    
    # 루트 경로 접속 시 영어 버전으로 리다이렉트
    RewriteCond %{REQUEST_URI} ^/$
    RewriteRule ^$ /index_v2.html [L]
</IfModule>

# CORS 설정 (API 요청용)
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
</IfModule>

# 에러 페이지 설정 (선택사항)
ErrorDocument 404 /index_v2.html
ErrorDocument 500 /index_v2.html